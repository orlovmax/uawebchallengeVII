!function(root,factory){"object"==typeof exports?factory(exports):"function"==typeof define&&define.amd?define(["exports"],factory):factory(root)}(this,function(exports){function ProgressJs(obj){this._targetElement="undefined"!=typeof obj.length?obj:[obj],"undefined"==typeof window._progressjsId&&(window._progressjsId=1),"undefined"==typeof window._progressjsIntervals&&(window._progressjsIntervals={}),this._options={theme:"blue",overlayMode:!1,considerTransition:!0}}function _startProgress(){"undefined"!=typeof this._onBeforeStartCallback&&this._onBeforeStartCallback.call(this),_createContainer.call(this);for(var i=0,elmsLength=this._targetElement.length;elmsLength>i;i++)_setProgress.call(this,this._targetElement[i])}function _setProgress(targetElement){if(!targetElement.hasAttribute("data-progressjs")){var targetElementOffset=_getOffset.call(this,targetElement);targetElement.setAttribute("data-progressjs",window._progressjsId);var progressElementContainer=document.createElement("div");progressElementContainer.className="progressjs-progress progressjs-theme-"+this._options.theme,progressElementContainer.style.position="body"===targetElement.tagName.toLowerCase()?"fixed":"absolute",progressElementContainer.setAttribute("data-progressjs",window._progressjsId);var progressElement=document.createElement("div");progressElement.className="progressjs-inner";var progressPercentElement=document.createElement("div");progressPercentElement.className="progressjs-percent",progressPercentElement.innerHTML="1%",progressElement.appendChild(progressPercentElement),this._options.overlayMode&&"body"===targetElement.tagName.toLowerCase()?(progressElementContainer.style.left=0,progressElementContainer.style.right=0,progressElementContainer.style.top=0,progressElementContainer.style.bottom=0):(progressElementContainer.style.left=targetElementOffset.left+"px",progressElementContainer.style.top=targetElementOffset.top+"px",progressElementContainer.style.width=targetElementOffset.width+"px",this._options.overlayMode&&(progressElementContainer.style.height=targetElementOffset.height+"px")),progressElementContainer.appendChild(progressElement);var container=document.querySelector(".progressjs-container");container.appendChild(progressElementContainer),_setPercentFor(targetElement,1),++window._progressjsId}}function _setPercent(percent){for(var i=0,elmsLength=this._targetElement.length;elmsLength>i;i++)_setPercentFor.call(this,this._targetElement[i],percent)}function _setPercentFor(targetElement,percent){var self=this;percent>=100&&(percent=100),targetElement.hasAttribute("data-progressjs")&&setTimeout(function(){"undefined"!=typeof self._onProgressCallback&&self._onProgressCallback.call(self,targetElement,percent);var percentElement=_getPercentElement(targetElement);percentElement.style.width=parseInt(percent)+"%";var percentElement=percentElement.querySelector(".progressjs-percent"),existingPercent=parseInt(percentElement.innerHTML.replace("%",""));!function(percentElement,existingPercent,currentPercent){function changePercentTimer(percentElement,existingPercent,currentPercent){var distance=Math.abs(existingPercent-currentPercent);3>distance?intervalIn=30:20>distance?intervalIn=20:intervanIn=1,existingPercent-currentPercent!=0&&(percentElement.innerHTML=(increasement?++existingPercent:--existingPercent)+"%",setTimeout(function(){changePercentTimer(percentElement,existingPercent,currentPercent)},intervalIn))}var increasement=!0;existingPercent>currentPercent&&(increasement=!1);var intervalIn=10;changePercentTimer(percentElement,existingPercent,currentPercent)}(percentElement,existingPercent,parseInt(percent))},50)}function _getPercentElement(targetElement){var progressjsId=parseInt(targetElement.getAttribute("data-progressjs"));return document.querySelector('.progressjs-container > .progressjs-progress[data-progressjs="'+progressjsId+'"] > .progressjs-inner')}function _autoIncrease(size,millisecond){var self=this,progressjsId=parseInt(this._targetElement[0].getAttribute("data-progressjs"));"undefined"!=typeof window._progressjsIntervals[progressjsId]&&clearInterval(window._progressjsIntervals[progressjsId]),window._progressjsIntervals[progressjsId]=setInterval(function(){_increasePercent.call(self,size)},millisecond)}function _increasePercent(size){for(var i=0,elmsLength=this._targetElement.length;elmsLength>i;i++){var currentElement=this._targetElement[i];if(currentElement.hasAttribute("data-progressjs")){var percentElement=_getPercentElement(currentElement),existingPercent=parseInt(percentElement.style.width.replace("%",""));existingPercent&&_setPercentFor.call(this,currentElement,existingPercent+(size||1))}}}function _end(){"undefined"!=typeof this._onBeforeEndCallback&&(this._options.considerTransition===!0?_getPercentElement(this._targetElement[0]).addEventListener(whichTransitionEvent(),this._onBeforeEndCallback,!1):this._onBeforeEndCallback.call(this));for(var progressjsId=parseInt(this._targetElement[0].getAttribute("data-progressjs")),i=0,elmsLength=this._targetElement.length;elmsLength>i;i++){var currentElement=this._targetElement[i],percentElement=_getPercentElement(currentElement);if(!percentElement)return;var existingPercent=parseInt(percentElement.style.width.replace("%","")),timeoutSec=1;100>existingPercent&&(_setPercentFor.call(this,currentElement,100),timeoutSec=500),function(percentElement,currentElement){setTimeout(function(){percentElement.parentNode.className+=" progressjs-end",setTimeout(function(){percentElement.parentNode.parentNode.removeChild(percentElement.parentNode),currentElement.removeAttribute("data-progressjs")},1e3)},timeoutSec)}(percentElement,currentElement)}if(window._progressjsIntervals[progressjsId])try{clearInterval(window._progressjsIntervals[progressjsId]),window._progressjsIntervals[progressjsId]=null,delete window._progressjsIntervals[progressjsId]}catch(ex){}}function _createContainer(){if(!document.querySelector(".progressjs-container")){var containerElement=document.createElement("div");containerElement.className="progressjs-container",document.body.appendChild(containerElement)}}function _getOffset(element){var elementPosition={};"body"===element.tagName.toLowerCase()?(elementPosition.width=element.clientWidth,elementPosition.height=element.clientHeight):(elementPosition.width=element.offsetWidth,elementPosition.height=element.offsetHeight);for(var _x=0,_y=0;element&&!isNaN(element.offsetLeft)&&!isNaN(element.offsetTop);)_x+=element.offsetLeft,_y+=element.offsetTop,element=element.offsetParent;return elementPosition.top=_y,elementPosition.left=_x,elementPosition}function _mergeOptions(obj1,obj2){var obj3={};for(var attrname in obj1)obj3[attrname]=obj1[attrname];for(var attrname in obj2)obj3[attrname]=obj2[attrname];return obj3}function whichTransitionEvent(){var t,el=document.createElement("fakeelement"),transitions={transition:"transitionend",OTransition:"oTransitionEnd",MozTransition:"transitionend",WebkitTransition:"webkitTransitionEnd"};for(t in transitions)if(void 0!==el.style[t])return transitions[t]}var VERSION="0.1.0",progressJs=function(targetElm){if("object"==typeof targetElm)return new ProgressJs(targetElm);if("string"==typeof targetElm){var targetElement=document.querySelectorAll(targetElm);if(targetElement)return new ProgressJs(targetElement);throw new Error("There is no element with given selector.")}return new ProgressJs(document.body)};return progressJs.version=VERSION,progressJs.fn=ProgressJs.prototype={clone:function(){return new ProgressJs(this)},setOption:function(option,value){return this._options[option]=value,this},setOptions:function(options){return this._options=_mergeOptions(this._options,options),this},start:function(){return _startProgress.call(this),this},set:function(percent){return _setPercent.call(this,percent),this},increase:function(size){return _increasePercent.call(this,size),this},autoIncrease:function(size,millisecond){return _autoIncrease.call(this,size,millisecond),this},end:function(){return _end.call(this),this},onbeforeend:function(providedCallback){if("function"!=typeof providedCallback)throw new Error("Provided callback for onbeforeend was not a function");return this._onBeforeEndCallback=providedCallback,this},onbeforestart:function(providedCallback){if("function"!=typeof providedCallback)throw new Error("Provided callback for onbeforestart was not a function");return this._onBeforeStartCallback=providedCallback,this},onprogress:function(providedCallback){if("function"!=typeof providedCallback)throw new Error("Provided callback for onprogress was not a function");return this._onProgressCallback=providedCallback,this}},exports.progressJs=progressJs,progressJs});